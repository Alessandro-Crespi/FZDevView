{"version":3,"sources":["controllers/payments_controller.js","pages/dashboard/account/home/sections/payments.js"],"names":["PaymentsController","a","link","$","ajax","type","url","api_url","accepts","contentType","beforeSend","beforeSendCallback","success","data","list","productId","Payments","useState","payments","products","setProducts","userPortal","setUserPortal","showPopup","setShowPopup","window","open","checkout","useEffect","getProducts","getUserPortal","id","className","onClick","length","map","item","i","buy","price","product_name","amount","Skeleton","height","removeFunction","isError","message"],"mappings":"mNAIMA,E,WACJ,aAAe,oB,wFAEf,4BAAAC,EAAA,6DAEMC,EAAO,GAFb,SAIQC,IAAEC,KAAK,CACXC,KAAM,MACNC,IAAKC,IAAU,qBACfC,QAAS,OACTC,YAAa,OACbC,WAAYC,IACZC,QAAS,SAACC,GAAD,OAAUX,EAAOW,KAV9B,gCAaSX,GAbT,2C,sHAgBA,4BAAAD,EAAA,6DAEMa,EAAO,GAFb,SAIQX,IAAEC,KAAK,CACXC,KAAM,MACNC,IAAKC,IAAU,kBACfC,QAAS,OACTC,YAAa,OACbC,WAAYC,IACZC,QAAS,SAACC,GAAD,OAAUC,EAAOD,EAAI,YAVlC,gCAaSC,GAbT,2C,mHAgBA,WAAeC,GAAf,eAAAd,EAAA,6DAEMC,EAAO,GAFb,SAIQC,IAAEC,KAAK,CACXC,KAAM,OACNC,IAAKC,IAAU,qBAAuBQ,EACtCP,QAAS,OACTC,YAAa,OACbC,WAAYC,IACZC,QAAS,SAACC,GAAD,OAAUX,EAAOW,KAV9B,gCAaSX,GAbT,2C,8DAiBaF,I,wBCcAgB,UAhEf,WACE,MAAgCC,mBAAS,IAAIjB,GAA7C,mBAAOkB,EAAP,KACA,GADA,KACgCD,mBAAS,KAAzC,mBAAOE,EAAP,KAAiBC,EAAjB,KACA,EAAoCH,mBAAS,IAA7C,mBAAOI,EAAP,KAAmBC,EAAnB,KACA,EAAkCL,oBAAS,GAA3C,mBAAOM,EAAP,KAAkBC,EAAlB,KAJkB,4CAMlB,sBAAAvB,EAAA,sDACEuB,GAAa,GACbC,OAAOC,KAAKL,EAAY,SAF1B,4CANkB,kEAWlB,WAAmBN,GAAnB,eAAAd,EAAA,6DACEuB,GAAa,GADf,SAEmBN,EAASS,SAASZ,GAFrC,OAEMb,EAFN,OAGEuB,OAAOC,KAAKxB,EAAM,SAHpB,4CAXkB,sBAwBlB,OAPA0B,oBAAS,sBAAC,8BAAA3B,EAAA,sEACSiB,EAASW,cADlB,cACJf,EADI,OAERM,EAAYN,GAFJ,SAGSI,EAASY,gBAHlB,OAGJ5B,EAHI,OAIRoB,EAAcpB,GAJN,2CAKP,IAGD,sBAAK6B,GAAI,WAAT,UACE,sBAAKC,UAAU,gBAAf,UACE,oBAAIA,UAAU,eAAd,yBACA,qBAAKA,UAAU,WAAf,SAEkB,IAAdX,EACE,wBAAQW,UAAU,SAASC,QA/BrB,2CA+BN,kBACA,QAKR,uBACA,qBAAKD,UAAU,OAAf,SAEuB,GAAnBb,EAASe,OACPf,EAASgB,KAAI,SAACC,EAAMC,GAAP,OACX,sBAAKL,UAAU,mBAAmBC,QAAS,kBA1CrC,2CA0C2CK,CAAIF,EAAKG,MAAMR,KAAhE,UACA,oBAAIC,UAAU,cAAd,SAA6BK,EAAI,IACjC,oBAAIL,UAAU,cAAd,SAA6BI,EAAKI,eAClC,oBAAGR,UAAU,kBAAb,UAAgCI,EAAKG,MAAME,OAA3C,kBAGJ,gCACE,cAACC,EAAA,EAAD,CAAUC,OAAO,QAAQX,UAAU,QACnC,cAACU,EAAA,EAAD,CAAUC,OAAO,UACjB,cAACD,EAAA,EAAD,CAAUC,OAAO,eAKrBpB,EACE,cAAC,IAAD,CAAOqB,eAAgB,kBAAMpB,GAAa,IAAQqB,SAAS,EAAOC,QAAS,mBAC3E","file":"static/js/12.a13ea90f.chunk.js","sourcesContent":["import { api_url } from \"../App\"\r\nimport $ from \"jquery\"\r\nimport { beforeSendCallback } from '../utils'\r\n\r\nclass PaymentsController {\r\n  constructor() {}\r\n\r\n  async getUserPortal() {\r\n    //let accessToken = window.localStorage.getItem('accessToken')\r\n    let link = \"\"\r\n\r\n    await $.ajax({\r\n      type: \"GET\",\r\n      url: api_url + \"stripe/user_portal\",\r\n      accepts: \"json\",\r\n      contentType: \"json\",\r\n      beforeSend: beforeSendCallback,\r\n      success: (data) => link = data\r\n    })\r\n\r\n    return link\r\n  }\r\n\r\n  async getProducts() {\r\n    //let accessToken = window.localStorage.getItem('accessToken')\r\n    let list = []\r\n\r\n    await $.ajax({\r\n      type: \"GET\",\r\n      url: api_url + \"stripe/products\",\r\n      accepts: \"json\",\r\n      contentType: \"json\",\r\n      beforeSend: beforeSendCallback,\r\n      success: (data) => list = data['products']\r\n    })\r\n\r\n    return list\r\n  }\r\n\r\n  async checkout(productId) {\r\n    //let accessToken = window.localStorage.getItem('accessToken')\r\n    let link = \"\"\r\n    \r\n    await $.ajax({\r\n      type: \"POST\",\r\n      url: api_url + \"/stripe/check_out/\" + productId,\r\n      accepts: \"json\",\r\n      contentType: \"json\",\r\n      beforeSend: beforeSendCallback,\r\n      success: (data) => link = data\r\n    })\r\n\r\n    return link\r\n  }\r\n}\r\n\r\nexport default PaymentsController","import React, { useEffect, useState } from 'react'\nimport PaymentsController from '../../../../../controllers/payments_controller'\nimport {Row, Col} from \"react-bootstrap\"\nimport { Skeleton } from '@mui/material'\nimport Popup from '../../../../../components/popup'\n\nfunction Payments() {\n  const [payments, setPayments] = useState(new PaymentsController())\n  const [products, setProducts] = useState([])\n  const [userPortal, setUserPortal] = useState(\"\")\n  const [showPopup, setShowPopup] = useState(false)\n\n  async function openInfo() {\n    setShowPopup(true)\n    window.open(userPortal, \"blank\")\n  }\n\n  async function buy(productId) {\n    setShowPopup(true)\n    let link = await payments.checkout(productId)\n    window.open(link, \"blank\")\n  }\n\n  useEffect(async () => {\n    let list = await payments.getProducts()\n    setProducts(list)\n    let link = await payments.getUserPortal()\n    setUserPortal(link)\n  }, [])\n  \n  return (\n    <div id={\"payments\"}>\n      <div className=\"space_between\">\n        <h2 className=\"m-0 centered\">Abbonamento</h2>\n        <div className=\"centered\">\n          {\n            userPortal != \"\" ?\n              <button className=\"button\" onClick={openInfo}>Info</button> : \n              \"\"\n\n          }\n        </div> \n      </div>\n      <br/>\n      <div className=\"grid\">\n        {\n          products.length != 0 ? \n            products.map((item, i) => (\n              <div className=\"block bounce m-2\" onClick={() => buy(item.price.id)}>\n              <h1 className=\"text-center\">{i + 1}</h1>\n              <h5 className=\"text-center\">{item.product_name}</h5>\n              <p className=\"text-center m-0\">{item.price.amount}â‚¬</p>\n            </div>\n          )) :\n          <div>\n            <Skeleton height=\"100px\" className=\"m-0\" />\n            <Skeleton height=\"100px\" />\n            <Skeleton height=\"100px\" />\n          </div>\n        }\n      </div>\n      {\n        showPopup ?\n          <Popup removeFunction={() => setShowPopup(false)} isError={false} message={\"Caricamento...\"}/> :\n          \"\"\n      }\n    </div>\n  )\n}\n\nexport default Payments"],"sourceRoot":""}