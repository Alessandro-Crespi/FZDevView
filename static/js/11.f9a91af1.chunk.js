(this.webpackJsonpnova_investor=this.webpackJsonpnova_investor||[]).push([[11],{500:function(e,t,n){"use strict";var c=n(27);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=c(n(28)),s=n(0),r=(0,a.default)((0,s.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"}),"AddCircle");t.default=r},521:function(e,t,n){"use strict";n.r(t);var c=n(12),a=n(3),s=n(4),r=n.n(s),i=n(1),o=n(23),u=n(21),l=n(19),h=n(223),d=n(78),j=n(11),f=n.n(j),b=n(16),p=n(13),v=function(){function e(){Object(u.a)(this,e),this.quiz=[],this.list=[],this.state=void 0,this.overrideState=void 0}return Object(l.a)(e,[{key:"setState",value:function(e){this.state=e}},{key:"setOverrideState",value:function(e){this.overrideState=e}},{key:"updateInfo",value:function(){if(void 0!=this.state){var t=new e;Object.assign(t,this),this.state(t)}else void 0!=this.overrideState&&this.overrideState()}},{key:"getList",value:function(){return this.list}},{key:"getQuiz",value:function(){return this.quiz}},{key:"setList",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.list=e,t&&this.updateInfo()}},{key:"setQuiz",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.quiz=e,t&&this.updateInfo()}},{key:"addQuiz",value:function(){var e=this,t=new d.a;t.question.setTitle("Nuovo quiz"),t.setOverrideState(function(){return e.updateInfo()}.bind(this)),this.quiz.push(t),this.updateInfo()}},{key:"deleteQuiz",value:function(){var e=Object(c.a)(r.a.mark((function e(t){var n,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!1,""==t.question.getId()){e.next=4;break}return e.next=4,f.a.ajax({type:"DELETE",url:b.a+"school/quiz/"+t.question.getId(),accepts:"application/json",contentType:"application/json",beforeSend:p.a,error:function(){return n=!0}});case 4:if(!n){e.next=8;break}throw Error("Errore nell'eliminazione");case 8:c=this.quiz.indexOf(t),this.quiz.splice(c,1),this.updateInfo();case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteSchool",value:function(){var e=Object(c.a)(r.a.mark((function e(t){var n,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!1,e.next=3,f.a.ajax({type:"DELETE",url:b.a+"school/"+t.getId(),accepts:"application/json",contentType:"application/json",beforeSend:p.a,error:function(){return n=!0}});case 3:if(!n){e.next=7;break}throw Error("Errore nell'eliminazione");case 7:c=this.list.indexOf(t),this.list.splice(c,1),this.updateInfo();case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadList",value:function(){var e=Object(c.a)(r.a.mark((function e(){var t,n,c,a,s,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},n=!1,e.next=4,f.a.ajax({type:"GET",url:b.a+"schools",accepts:"application/json",contentType:"application/json",beforeSend:p.a,success:function(e){return t=e.schools},error:function(){return n=!0}});case 4:c=Object(o.a)(t);try{for(c.s();!(a=c.n()).done;)s=a.value,(i=new h.a).setId(s.slug),i.setName(s.schoolName),i.setCode(s.code),i.setQuizNumber(s.quizNumber),this.list.push(i)}catch(r){c.e(r)}finally{c.f()}return this.updateInfo(),e.abrupt("return",{error:n,info:t});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadQuiz",value:function(){var e=Object(c.a)(r.a.mark((function e(){var t,n,c,a,s,i,u,l,h,j=this,v=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v.length>0&&void 0!==v[0]&&v[0],t={},n=!1,0!=this.quiz.length){e.next=8;break}return e.next=6,f.a.ajax({type:"GET",url:b.a+"school/quiz",accepts:"application/json",contentType:"application/json",beforeSend:p.a,success:function(e){return t=e.quiz},error:function(){return n=!0}});case 6:c=Object(o.a)(t);try{for(c.s();!(a=c.n()).done;){s=a.value,(i=new d.a).setOverrideState(function(){return j.updateInfo()}.bind(this)),i.question.setId(s.slug),i.question.setTitle(s.question),i.question.setImage(s.coverImageLink),u=Object(o.a)(s.answers);try{for(u.s();!(l=u.n()).done;)h=l.value,i.question.addChoice({title:h.answer,description:h.description},h.slug),h.isCorrect&&i.question.addSelectedChoice(h.slug)}catch(r){u.e(r)}finally{u.f()}this.quiz.push(i),this.updateInfo()}}catch(r){c.e(r)}finally{c.f()}case 8:return e.abrupt("return",{error:n,info:t});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"publishQuiz",value:function(){var e=Object(c.a)(r.a.mark((function e(){var t,n,c,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="school",n=Object(o.a)(this.getQuiz()),e.prev=2,n.s();case 4:if((c=n.n()).done){e.next=11;break}return a=c.value,e.next=8,a.publish(t);case 8:e.sent;case 9:e.next=4;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[2,13,16,19]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),O=v,x=n(435),m=n(434),g=n(217),k=n.n(g),y=n(500),z=n.n(y),N=n(462),w=n(494),q=n(202),S=n(475),I=n(489),_=n(490),C=n(148),E=n(61),Q=n.n(E),T=n(60),L=n.n(T),P=n(15),F=n(46),A=n(98),D=n(0);t.default=function(e){var t="list",n="quiz",s=Object(P.f)(),o=Object(i.useState)(t),u=Object(a.a)(o,2),l=u[0],h=u[1],d=Object(i.useState)(new O),j=Object(a.a)(d,2),f=j[0],b=j[1],p=Object(i.useState)(""),v=Object(a.a)(p,2),g=v[0],y=v[1],E=Object(i.useState)({}),T=Object(a.a)(E,2),G=T[0],J=T[1],M=Object(i.useState)({confirm:void 0,refute:void 0}),B=Object(a.a)(M,2),H=B[0],V=B[1],K=e.user;function R(){return(R=Object(c.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:J({error:!1,message:"Pubblicazione in corso..."}),t.publish("school").then((function(){return J({error:!1,message:"Pubblicazione completata"})})).catch((function(e){J({error:!0,message:"Errore"}),console.warn(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(i.useEffect)((function(){f.setState(b),K&&K.canI("create_school")&&f.loadList()}),[]),Object(i.useEffect)((function(){l==n&&K&&K.canI("create_school")&&f.loadQuiz()}),[l]),Object(i.useEffect)((function(){K&&(K.canI("create_school")||s(q.a.account_home.path))}),[K]),Object(D.jsxs)("div",{id:"school_section",children:[Object(D.jsxs)("div",{className:"space_between",children:[Object(D.jsx)("h2",{children:"Scuola"}),l==t&&K&&K.canI("create_school")?Object(D.jsx)("div",{className:"centered",children:Object(D.jsx)(z.a,{className:"orange_icon",onClick:function(){s(q.a.school_creation.path,{state:{school:void 0}})}})}):""]}),Object(D.jsxs)(N.a,{value:l,onChange:function(e,t){return h(t)},scrollButtons:"auto",children:[Object(D.jsx)(w.a,{label:"Scuole",value:t}),Object(D.jsx)(w.a,{label:"Quiz",value:n})]}),Object(D.jsx)("br",{}),l==t?Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)(x.a,{children:[Object(D.jsx)(m.a,{md:"6",children:Object(D.jsx)("h5",{children:"Nome"})}),Object(D.jsx)(m.a,{md:"3",children:Object(D.jsx)("h5",{children:"Codice"})})]}),Object(D.jsx)("div",{className:"list_container m-2",children:f.getList().map((function(e){return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)(x.a,{className:"bounce",onClick:function(){return function(e){s(q.a.school_creation.path,{state:{school:e.exportInfo()}})}(e)},children:[Object(D.jsx)(m.a,{md:"6",children:Object(D.jsx)("p",{className:"m-0",children:e.getName()})}),Object(D.jsx)(m.a,{md:"4",children:Object(D.jsx)("p",{className:"m-0",children:e.getCode()})}),Object(D.jsxs)(m.a,{md:"2",children:[Object(D.jsx)(L.a,{className:"orange_icon",onClick:function(t){return function(e,t){e.stopPropagation(),V({confirm:function(){return f.deleteSchool(t)},refute:void 0})}(t,e)}}),Object(D.jsx)(k.a,{className:"orange_icon m-0"})]})]}),Object(D.jsx)("hr",{})]})}))})]}):Object(D.jsx)(D.Fragment,{children:Object(D.jsxs)("div",{className:"block",children:[Object(D.jsxs)(x.a,{children:[Object(D.jsx)(m.a,{md:"8",children:Object(D.jsx)("h5",{children:"Quiz"})}),Object(D.jsx)(m.a,{md:"4",children:Object(D.jsx)("input",{className:"input",placeholder:"Cerca...",value:g,onChange:function(e){return y(e.target.value)}})})]}),Object(D.jsx)("br",{}),f.getQuiz().map((function(e){return e.question.getTitle().includes(g)?Object(D.jsxs)(S.a,{className:"accordion",children:[Object(D.jsx)(I.a,{expandIcon:Object(D.jsx)(Q.a,{className:"orange_icon"}),children:Object(D.jsxs)("div",{className:"space_between",style:{width:"100%"},children:[Object(D.jsx)("h6",{className:"m-2",children:e.question.getTitle()}),Object(D.jsx)("div",{className:"centered",children:Object(D.jsx)(L.a,{className:"orange_icon",onClick:function(t){return function(e,t){e.stopPropagation(),V({confirm:function(){return f.deleteQuiz(t)},refute:void 0})}(t,e)}})})]})}),Object(D.jsxs)(_.a,{children:[Object(D.jsx)(C.a,{question:e}),Object(D.jsx)("div",{className:"centered",children:Object(D.jsx)("button",{className:"button",onClick:function(){return function(e){return R.apply(this,arguments)}(e)},children:"Salva"})})]}),Object(D.jsx)("br",{}),Object(D.jsx)("hr",{}),Object(D.jsx)("br",{})]}):""})),Object(D.jsx)("div",{className:"centered",children:Object(D.jsx)("button",{className:"button",onClick:function(){return f.addQuiz()},children:"Aggiungi domanda"})})]})}),void 0!=G.error?Object(D.jsx)(F.a,{error:G.error,message:G.message,removePopup:function(){return J({})}}):"",Object(D.jsx)(A.a,{action:H,closeFunction:function(){return V({confirm:void 0,refute:void 0})}})]})}}}]);
//# sourceMappingURL=11.f9a91af1.chunk.js.map